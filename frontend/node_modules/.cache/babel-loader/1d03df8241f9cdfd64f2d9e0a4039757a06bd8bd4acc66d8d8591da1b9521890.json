{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import toast from'react-hot-toast';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};// Configure axios defaults\naxios.defaults.baseURL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';axios.defaults.withCredentials=true;// Add response interceptor for handling auth errors\naxios.interceptors.response.use(response=>response,error=>{var _error$response;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){// Token expired or invalid\nwindow.location.href='/login';}return Promise.reject(error);});export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[isAuthenticated,setIsAuthenticated]=useState(false);// Check if user is authenticated on app load\nuseEffect(()=>{checkAuth();},[]);const checkAuth=async()=>{try{const response=await axios.get('/auth/me');setUser(response.data.user);setIsAuthenticated(true);}catch(error){setUser(null);setIsAuthenticated(false);}finally{setLoading(false);}};const login=async(email,password)=>{try{const response=await axios.post('/auth/login',{email,password});setUser(response.data.user);setIsAuthenticated(true);toast.success('Login successful!');return{success:true,user:response.data.user};}catch(error){var _error$response2,_error$response2$data;const message=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Login failed';toast.error(message);return{success:false,message};}};const signup=async userData=>{try{const response=await axios.post('/auth/signup',userData);toast.success('Account created! Please wait for admin approval.');return{success:true,message:response.data.message};}catch(error){var _error$response3,_error$response3$data;const message=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Signup failed';toast.error(message);return{success:false,message};}};const logout=async()=>{try{await axios.post('/auth/logout');setUser(null);setIsAuthenticated(false);toast.success('Logged out successfully');}catch(error){// Even if logout fails on server, clear local state\nsetUser(null);setIsAuthenticated(false);toast.error('Logout failed');}};const updateUser=updatedUser=>{setUser(updatedUser);};const isAdmin=()=>{return(user===null||user===void 0?void 0:user.role)==='ADMIN';};const isPhotographer=()=>{return(user===null||user===void 0?void 0:user.role)==='PHOTOGRAPHER';};const isApproved=()=>{return(user===null||user===void 0?void 0:user.status)==='APPROVED';};const isPending=()=>{return(user===null||user===void 0?void 0:user.status)==='PENDING';};const isRejected=()=>{return(user===null||user===void 0?void 0:user.status)==='REJECTED';};const value={user,loading,isAuthenticated,login,signup,logout,updateUser,checkAuth,isAdmin,isPhotographer,isApproved,isPending,isRejected};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","toast","jsx","_jsx","AuthContext","useAuth","context","Error","defaults","baseURL","process","env","REACT_APP_API_URL","withCredentials","interceptors","response","use","error","_error$response","status","window","location","href","Promise","reject","AuthProvider","_ref","children","user","setUser","loading","setLoading","isAuthenticated","setIsAuthenticated","checkAuth","get","data","login","email","password","post","success","_error$response2","_error$response2$data","message","signup","userData","_error$response3","_error$response3$data","logout","updateUser","updatedUser","isAdmin","role","isPhotographer","isApproved","isPending","isRejected","value","Provider"],"sources":["C:/Users/USER/Desktop/Gallerypavilion/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport toast from 'react-hot-toast';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\n// Configure axios defaults\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\naxios.defaults.withCredentials = true;\n\n// Add response interceptor for handling auth errors\naxios.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      // Token expired or invalid\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  // Check if user is authenticated on app load\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await axios.get('/auth/me');\n      setUser(response.data.user);\n      setIsAuthenticated(true);\n    } catch (error) {\n      setUser(null);\n      setIsAuthenticated(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (email, password) => {\n    try {\n      const response = await axios.post('/auth/login', { email, password });\n      setUser(response.data.user);\n      setIsAuthenticated(true);\n      toast.success('Login successful!');\n      return { success: true, user: response.data.user };\n    } catch (error) {\n      const message = error.response?.data?.message || 'Login failed';\n      toast.error(message);\n      return { success: false, message };\n    }\n  };\n\n  const signup = async (userData) => {\n    try {\n      const response = await axios.post('/auth/signup', userData);\n      toast.success('Account created! Please wait for admin approval.');\n      return { success: true, message: response.data.message };\n    } catch (error) {\n      const message = error.response?.data?.message || 'Signup failed';\n      toast.error(message);\n      return { success: false, message };\n    }\n  };\n\n  const logout = async () => {\n    try {\n      await axios.post('/auth/logout');\n      setUser(null);\n      setIsAuthenticated(false);\n      toast.success('Logged out successfully');\n    } catch (error) {\n      // Even if logout fails on server, clear local state\n      setUser(null);\n      setIsAuthenticated(false);\n      toast.error('Logout failed');\n    }\n  };\n\n  const updateUser = (updatedUser) => {\n    setUser(updatedUser);\n  };\n\n  const isAdmin = () => {\n    return user?.role === 'ADMIN';\n  };\n\n  const isPhotographer = () => {\n    return user?.role === 'PHOTOGRAPHER';\n  };\n\n  const isApproved = () => {\n    return user?.status === 'APPROVED';\n  };\n\n  const isPending = () => {\n    return user?.status === 'PENDING';\n  };\n\n  const isRejected = () => {\n    return user?.status === 'REJECTED';\n  };\n\n  const value = {\n    user,\n    loading,\n    isAuthenticated,\n    login,\n    signup,\n    logout,\n    updateUser,\n    checkAuth,\n    isAdmin,\n    isPhotographer,\n    isApproved,\n    isPending,\n    isRejected,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
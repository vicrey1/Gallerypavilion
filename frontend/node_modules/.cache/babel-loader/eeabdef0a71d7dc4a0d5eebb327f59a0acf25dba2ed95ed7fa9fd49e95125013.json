{"ast":null,"code":"import _objectSpread from\"C:/Users/USER/Desktop/Gallerypavilion/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useRef}from'react';import{useParams,useSearchParams,useNavigate}from'react-router-dom';import{motion,AnimatePresence}from'framer-motion';import{Eye,Download,Heart,Share2,X,ChevronLeft,ChevronRight,ZoomIn,ZoomOut,RotateCw,Info,Camera,Calendar,Lock,Unlock,Mail,Sun,Moon}from'lucide-react';import{toast}from'react-hot-toast';import axios from'axios';import Masonry from'react-masonry-css';import{LazyLoadImage}from'react-lazy-load-image-component';import'react-lazy-load-image-component/src/effects/blur.css';import'./GalleryView.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GalleryView=_ref=>{var _selectedPhoto$metada,_selectedPhoto$metada2,_selectedPhoto$metada3,_selectedPhoto$metada4,_selectedPhoto$metada5;let{galleryId:propGalleryId,isSharedView=false}=_ref;const{galleryId:paramGalleryId}=useParams();const[searchParams]=useSearchParams();const token=searchParams.get('token');const password=searchParams.get('password');// Use prop galleryId if provided, otherwise use URL param\nconst galleryId=propGalleryId||paramGalleryId;// For shared view, treat galleryId as token\nconst actualToken=isSharedView?galleryId:token;const[gallery,setGallery]=useState(null);const[photos,setPhotos]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[selectedPhoto,setSelectedPhoto]=useState(null);const[lightboxIndex,setLightboxIndex]=useState(0);const[showLightbox,setShowLightbox]=useState(false);const[showInfo,setShowInfo]=useState(false);const[zoom,setZoom]=useState(1);const[rotation,setRotation]=useState(0);const[favorites,setFavorites]=useState(new Set());// removed unused: shareLink, passwordRequired, invitationRequired\nconst[enteredPassword,setEnteredPassword]=useState('');const[enteredInvitation,setEnteredInvitation]=useState('');const[passwordError,setPasswordError]=useState(null);const[invitationError,setInvitationError]=useState(null);const[retryCount,setRetryCount]=useState(0);const[showPasswordModal,setShowPasswordModal]=useState(false);const[showInvitationModal,setShowInvitationModal]=useState(false);const lightboxRef=useRef(null);const imageRef=useRef(null);// Theme and navigation\nconst navigate=useNavigate();const getSystemTheme=()=>typeof window!=='undefined'&&window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light';const[theme,setTheme]=useState(getSystemTheme());const darkBg='#0b0b0b';const lightBg='#f7f7f9';const toggleTheme=useCallback(()=>{setTheme(prev=>prev==='dark'?'light':'dark');},[]);useEffect(()=>{if(!window.matchMedia)return;const mql=window.matchMedia('(prefers-color-scheme: dark)');const handler=e=>setTheme(e.matches?'dark':'light');if(mql.addEventListener){mql.addEventListener('change',handler);}else if(mql.addListener){mql.addListener(handler);}return()=>{if(mql.removeEventListener){mql.removeEventListener('change',handler);}else if(mql.removeListener){mql.removeListener(handler);}};},[]);// Masonry breakpoints\nconst breakpointColumnsObj={default:4,1100:3,700:2,500:1};// Verify password for protected share links\nconst verifyPassword=useCallback(async passwordToVerify=>{try{const response=await axios.post(\"/share/\".concat(actualToken,\"/verify-password\"),{password:passwordToVerify});return response.data.verified;}catch(err){console.error('Password verification failed:',err);return false;}},[actualToken]);// Fetch gallery data\nconst fetchGallery=useCallback(async function(){let verifiedPassword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;try{var _data$gallery,_data$gallery2,_data$gallery3;setLoading(true);setError(null);const url=actualToken?\"/share/\".concat(actualToken):\"/galleries/\".concat(galleryId,\"/public\");const params={};if(actualToken&&(verifiedPassword||password)){params.password=verifiedPassword||password;}const response=await axios.get(url,{params});const data=response.data;// Normalize photographer info so UI can consistently use gallery.photographer.name and .email\nconst respPhotographer=data.photographer||((_data$gallery=data.gallery)===null||_data$gallery===void 0?void 0:_data$gallery.photographer);const normalizedPhotographer=respPhotographer&&typeof respPhotographer==='object'?_objectSpread(_objectSpread({},respPhotographer),{},{name:respPhotographer.name||\"\".concat(respPhotographer.firstName||'',\" \").concat(respPhotographer.lastName||'').trim(),email:respPhotographer.email||respPhotographer.clientEmail||undefined}):respPhotographer||undefined;const normalizedGallery=_objectSpread(_objectSpread({},data.gallery),{},{photographer:normalizedPhotographer||(typeof((_data$gallery2=data.gallery)===null||_data$gallery2===void 0?void 0:_data$gallery2.photographer)==='object'?_objectSpread(_objectSpread({},data.gallery.photographer),{},{name:data.gallery.photographer.name||\"\".concat(data.gallery.photographer.firstName||'',\" \").concat(data.gallery.photographer.lastName||'').trim()}):(_data$gallery3=data.gallery)===null||_data$gallery3===void 0?void 0:_data$gallery3.photographer)});setGallery(normalizedGallery);setPhotos(data.photos||[]);// removed unused setShareLink\n}catch(err){var _err$response,_err$response2,_err$response2$data,_err$response3,_err$response4,_err$response4$data,_err$response5,_err$response6,_err$response7,_err$response8,_err$response9,_err$response9$data;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401&&(_err$response2=err.response)!==null&&_err$response2!==void 0&&(_err$response2$data=_err$response2.data)!==null&&_err$response2$data!==void 0&&_err$response2$data.requiresPassword){setShowPasswordModal(true);return;}if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===403&&(_err$response4=err.response)!==null&&_err$response4!==void 0&&(_err$response4$data=_err$response4.data)!==null&&_err$response4$data!==void 0&&_err$response4$data.requiresInvitation){setShowInvitationModal(true);return;}console.error('Error fetching gallery:',err);// Provide specific error messages based on status code\nlet errorMessage='Failed to load gallery';if(((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.status)===404){errorMessage='Gallery not found or no longer available';}else if(((_err$response6=err.response)===null||_err$response6===void 0?void 0:_err$response6.status)===403){errorMessage='You do not have permission to access this gallery';}else if(((_err$response7=err.response)===null||_err$response7===void 0?void 0:_err$response7.status)===410){errorMessage='This gallery link has expired';}else if(((_err$response8=err.response)===null||_err$response8===void 0?void 0:_err$response8.status)>=500){errorMessage='Server error. Please try again later';}else if((_err$response9=err.response)!==null&&_err$response9!==void 0&&(_err$response9$data=_err$response9.data)!==null&&_err$response9$data!==void 0&&_err$response9$data.message){errorMessage=err.response.data.message;}else if(err.message.includes('Network Error')){errorMessage='Network error. Please check your connection and try again';}setError(errorMessage);setRetryCount(prev=>prev+1);}finally{setLoading(false);}},[galleryId,actualToken,password]);useEffect(()=>{fetchGallery();},[fetchGallery]);// Handle password submission\nconst handlePasswordSubmit=async e=>{e.preventDefault();setLoading(true);setPasswordError(null);try{// First verify the password\nconst isValid=await verifyPassword(enteredPassword);if(!isValid){setPasswordError('Incorrect password. Please try again.');setLoading(false);return;}// If password is valid, fetch gallery data\nsetShowPasswordModal(false);setError(null);await fetchGallery(enteredPassword);setEnteredPassword('');}catch(err){var _err$response0,_err$response1,_err$response10;console.error('Password submission error:',err);if(((_err$response0=err.response)===null||_err$response0===void 0?void 0:_err$response0.status)===401){setPasswordError('Incorrect password. Please try again.');}else if(((_err$response1=err.response)===null||_err$response1===void 0?void 0:_err$response1.status)===404){setPasswordError('Gallery not found or no longer available.');}else if(((_err$response10=err.response)===null||_err$response10===void 0?void 0:_err$response10.status)>=500){setPasswordError('Server error. Please try again later.');}else{setPasswordError('Failed to access gallery. Please try again.');}}finally{setLoading(false);}};// Handle invitation code submission\nconst handleInvitationSubmit=async e=>{e.preventDefault();setLoading(true);setInvitationError(null);try{var _data$gallery4,_data$gallery5,_data$gallery6;// Fetch gallery data with invitation code\nconst url=actualToken?\"/share/\".concat(actualToken):\"/galleries/\".concat(galleryId,\"/public\");const params={invite:enteredInvitation};if(actualToken&&password){params.password=password;}const response=await axios.get(url,{params});const data=response.data;// Normalize photographer info for consistency\nconst respPhotographer=data.photographer||((_data$gallery4=data.gallery)===null||_data$gallery4===void 0?void 0:_data$gallery4.photographer);const normalizedPhotographer=respPhotographer&&typeof respPhotographer==='object'?_objectSpread(_objectSpread({},respPhotographer),{},{name:respPhotographer.name||\"\".concat(respPhotographer.firstName||'',\" \").concat(respPhotographer.lastName||'').trim(),email:respPhotographer.email||respPhotographer.clientEmail||undefined}):respPhotographer||undefined;const normalizedGallery=_objectSpread(_objectSpread({},data.gallery),{},{photographer:normalizedPhotographer||(typeof((_data$gallery5=data.gallery)===null||_data$gallery5===void 0?void 0:_data$gallery5.photographer)==='object'?_objectSpread(_objectSpread({},data.gallery.photographer),{},{name:data.gallery.photographer.name||\"\".concat(data.gallery.photographer.firstName||'',\" \").concat(data.gallery.photographer.lastName||'').trim()}):(_data$gallery6=data.gallery)===null||_data$gallery6===void 0?void 0:_data$gallery6.photographer)});setGallery(normalizedGallery);setPhotos(data.photos||[]);setShowInvitationModal(false);setError(null);setEnteredInvitation('');}catch(err){var _err$response11,_err$response12,_err$response13;console.error('Invitation submission error:',err);if(((_err$response11=err.response)===null||_err$response11===void 0?void 0:_err$response11.status)===403){setInvitationError('Invalid or expired invitation code. Please try again.');}else if(((_err$response12=err.response)===null||_err$response12===void 0?void 0:_err$response12.status)===404){setInvitationError('Gallery not found or no longer available.');}else if(((_err$response13=err.response)===null||_err$response13===void 0?void 0:_err$response13.status)>=500){setInvitationError('Server error. Please try again later.');}else{setInvitationError('Failed to access gallery. Please try again.');}}finally{setLoading(false);}};// Open lightbox\nconst openLightbox=(photo,index)=>{setSelectedPhoto(photo);setLightboxIndex(index);setShowLightbox(true);setZoom(1);setRotation(0);document.body.style.overflow='hidden';};// Close lightbox\nconst closeLightbox=()=>{setShowLightbox(false);setSelectedPhoto(null);setShowInfo(false);setZoom(1);setRotation(0);document.body.style.overflow='auto';};// Navigate lightbox\nconst navigateLightbox=useCallback(direction=>{const newIndex=direction==='next'?(lightboxIndex+1)%photos.length:(lightboxIndex-1+photos.length)%photos.length;setLightboxIndex(newIndex);setSelectedPhoto(photos[newIndex]);setZoom(1);setRotation(0);},[lightboxIndex,photos]);// Handle keyboard navigation\nuseEffect(()=>{const handleKeyPress=e=>{if(!showLightbox)return;switch(e.key){case'Escape':closeLightbox();break;case'ArrowLeft':navigateLightbox('prev');break;case'ArrowRight':navigateLightbox('next');break;case'i':case'I':setShowInfo(!showInfo);break;default:break;}};window.addEventListener('keydown',handleKeyPress);return()=>window.removeEventListener('keydown',handleKeyPress);},[showLightbox,showInfo,lightboxIndex,navigateLightbox]);// Toggle favorite\nconst toggleFavorite=photoId=>{const newFavorites=new Set(favorites);if(newFavorites.has(photoId)){newFavorites.delete(photoId);}else{newFavorites.add(photoId);}setFavorites(newFavorites);};// Share gallery\nconst shareGallery=async()=>{try{if(navigator.share){await navigator.share({title:gallery.title,text:gallery.description,url:window.location.href});}else{await navigator.clipboard.writeText(window.location.href);toast.success('Gallery link copied to clipboard!');}}catch(err){console.error('Error sharing:',err);toast.error('Failed to share gallery');}};// Download photo\nconst downloadPhoto=async photo=>{try{const response=await axios.get(\"/photos/\".concat(photo._id,\"/download\"),{params:token?{token}:undefined,responseType:'blob'});const blob=response.data;const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=photo.filename||\"photo-\".concat(photo._id,\".jpg\");document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);toast.success('Photo downloaded successfully!');}catch(err){console.error('Error downloading photo:',err);toast.error('Failed to download photo');}};// Handle inquiry about a photo\nconst handleInquiry=photo=>{var _photo$metadata,_photo$metadata2,_photo$metadata2$purc;const subject=\"Inquiry about \\\"\".concat(photo.title||'Artwork',\"\\\"\");const body=\"Hi,\\n\\nI'm interested in learning more about the artwork \\\"\".concat(photo.title||'this piece',\"\\\"\").concat((_photo$metadata=photo.metadata)!==null&&_photo$metadata!==void 0&&_photo$metadata.artworkInfo?\" (\".concat(photo.metadata.artworkInfo.medium).concat(photo.metadata.artworkInfo.year?\", \".concat(photo.metadata.artworkInfo.year):'',\")\"):'',\".\\n\\n\").concat((_photo$metadata2=photo.metadata)!==null&&_photo$metadata2!==void 0&&(_photo$metadata2$purc=_photo$metadata2.purchaseInfo)!==null&&_photo$metadata2$purc!==void 0&&_photo$metadata2$purc.price?\"Listed price: $\".concat(photo.metadata.purchaseInfo.price.toLocaleString(),\"\\n\\n\"):'',\"Please provide more information about:\\n- Availability\\n- Pricing details\\n- Shipping information\\n- Any additional details\\n\\nThank you!\");const recipient=gallery&&gallery.photographer&&gallery.photographer.email?gallery.photographer.email:'';const mailtoLink=\"mailto:\".concat(encodeURIComponent(recipient),\"?subject=\").concat(encodeURIComponent(subject),\"&body=\").concat(encodeURIComponent(body));window.open(mailtoLink,'_blank');};// Format date\nconst formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});};// Format camera settings\nconst formatCameraSettings=exif=>{if(!exif)return null;const settings=[];if(exif.fNumber)settings.push(\"f/\".concat(exif.fNumber));if(exif.exposureTime)settings.push(\"\".concat(exif.exposureTime,\"s\"));if(exif.iso)settings.push(\"ISO \".concat(exif.iso));if(exif.focalLength)settings.push(\"\".concat(exif.focalLength,\"mm\"));return settings.length>0?settings.join(' • '):null;};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"gallery-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading gallery...\"})]});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"gallery-error\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Unable to Load Gallery\"}),/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"error-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setError(null);setRetryCount(0);fetchGallery();},className:\"retry-button\",disabled:loading,children:loading?'Retrying...':'Try Again'}),retryCount>2&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.href='/',className:\"home-button\",children:\"Go to Homepage\"})]}),retryCount>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-help\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Still having trouble? Try:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Checking your internet connection\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Refreshing the page\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Contacting the gallery owner\"})]})]})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"gallery-view \".concat(theme),style:{backgroundColor:theme==='dark'?darkBg:lightBg},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"animated-background\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"bg-gradient-1\",animate:{x:[0,100,0],y:[0,-50,0],rotate:[0,180,360]},transition:{duration:20,repeat:Infinity,ease:\"linear\"}}),/*#__PURE__*/_jsx(motion.div,{className:\"bg-gradient-2\",animate:{x:[0,-80,0],y:[0,100,0],rotate:[0,-180,-360]},transition:{duration:25,repeat:Infinity,ease:\"linear\"}}),/*#__PURE__*/_jsx(motion.div,{className:\"bg-gradient-3\",animate:{x:[0,60,0],y:[0,-80,0],scale:[1,1.2,1]},transition:{duration:30,repeat:Infinity,ease:\"linear\"}})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:showPasswordModal&&/*#__PURE__*/_jsx(motion.div,{className:\"password-modal-overlay\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:/*#__PURE__*/_jsxs(motion.div,{className:\"password-modal\",initial:{scale:0.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0.9,opacity:0},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"password-modal-header\",children:[/*#__PURE__*/_jsx(Lock,{className:\"lock-icon\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Password Required\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This gallery is password protected\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlePasswordSubmit,className:\"password-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"password-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:enteredPassword,onChange:e=>{setEnteredPassword(e.target.value);setPasswordError(null);// Clear error when user types\n},placeholder:\"Enter password\",className:\"password-input \".concat(passwordError?'error':''),autoFocus:true,required:true,disabled:loading}),passwordError&&/*#__PURE__*/_jsxs(\"div\",{className:\"password-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:passwordError})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"password-submit\",disabled:loading||!enteredPassword.trim(),children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),\"Verifying...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Unlock,{className:\"unlock-icon\"}),\"Access Gallery\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"password-modal-footer\",children:/*#__PURE__*/_jsx(\"p\",{className:\"help-text\",children:\"Don't have the password? Contact the gallery owner.\"})})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:showInvitationModal&&/*#__PURE__*/_jsx(motion.div,{className:\"password-modal-overlay\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:/*#__PURE__*/_jsxs(motion.div,{className:\"password-modal\",initial:{scale:0.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0.9,opacity:0},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"password-modal-header\",children:[/*#__PURE__*/_jsx(Lock,{className:\"lock-icon\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Invitation Required\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This gallery is invite-only. Please enter your invitation code.\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleInvitationSubmit,className:\"password-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"password-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:enteredInvitation,onChange:e=>{setEnteredInvitation(e.target.value);setInvitationError(null);// Clear error when user types\n},placeholder:\"Enter invitation code\",className:\"password-input \".concat(invitationError?'error':''),autoFocus:true,required:true,disabled:loading}),invitationError&&/*#__PURE__*/_jsxs(\"div\",{className:\"password-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:invitationError})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"password-submit\",disabled:loading||!enteredInvitation.trim(),children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),\"Verifying...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Unlock,{className:\"unlock-icon\"}),\"Access Gallery\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"password-modal-footer\",children:/*#__PURE__*/_jsx(\"p\",{className:\"help-text\",children:\"Don't have an invitation code? Contact the gallery owner.\"})})]})})}),gallery&&/*#__PURE__*/_jsxs(motion.div,{className:\"gallery-header\",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:0.6,ease:\"easeOut\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"gallery-info\",children:[/*#__PURE__*/_jsx(motion.h1,{className:\"gallery-title\",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:0.8,delay:0.2},children:gallery.title}),gallery.description&&/*#__PURE__*/_jsx(motion.p,{className:\"gallery-description\",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:0.8,delay:0.4},children:gallery.description}),/*#__PURE__*/_jsxs(motion.div,{className:\"gallery-meta\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.8,delay:0.6},children:[gallery.photographer&&/*#__PURE__*/_jsxs(motion.div,{className:\"photographer-info\",whileHover:{scale:1.05,x:5},transition:{type:\"spring\",stiffness:300},children:[/*#__PURE__*/_jsx(\"div\",{className:\"meta-icon-container\",children:/*#__PURE__*/_jsx(Camera,{className:\"meta-icon\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[\"by \",gallery.photographer.name]})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"photo-count\",whileHover:{scale:1.05,x:5},transition:{type:\"spring\",stiffness:300},children:[/*#__PURE__*/_jsx(\"div\",{className:\"meta-icon-container\",children:/*#__PURE__*/_jsx(Eye,{className:\"meta-icon\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[photos.length,\" photos\"]})]}),gallery.createdAt&&/*#__PURE__*/_jsxs(motion.div,{className:\"gallery-date\",whileHover:{scale:1.05,x:5},transition:{type:\"spring\",stiffness:300},children:[/*#__PURE__*/_jsx(\"div\",{className:\"meta-icon-container\",children:/*#__PURE__*/_jsx(Calendar,{className:\"meta-icon\"})}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(gallery.createdAt)})]})]})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"gallery-actions\",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:0.8,delay:0.8},children:[/*#__PURE__*/_jsxs(motion.button,{onClick:shareGallery,className:\"action-button\",whileHover:{scale:1.05,y:-2},whileTap:{scale:0.95},transition:{type:\"spring\",stiffness:300},children:[/*#__PURE__*/_jsx(Share2,{className:\"action-icon\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Share\"})]}),/*#__PURE__*/_jsxs(motion.button,{onClick:toggleTheme,className:\"action-button theme-toggle\",\"aria-label\":\"Toggle theme\",whileHover:{scale:1.05,y:-2},whileTap:{scale:0.95},transition:{type:\"spring\",stiffness:300},children:[/*#__PURE__*/_jsx(motion.div,{animate:{rotate:theme==='dark'?0:180},transition:{duration:0.5},children:theme==='dark'?/*#__PURE__*/_jsx(Sun,{className:\"action-icon\"}):/*#__PURE__*/_jsx(Moon,{className:\"action-icon\"})}),/*#__PURE__*/_jsx(\"span\",{children:theme==='dark'?'Light':'Dark'})]})]})]}),photos.length>0?/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:0.8,delay:1},children:/*#__PURE__*/_jsx(Masonry,{breakpointCols:breakpointColumnsObj,className:\"photo-masonry\",columnClassName:\"photo-masonry-column\",children:photos.map((photo,index)=>{var _photo$metadata3,_photo$metadata3$purc,_photo$metadata4,_photo$metadata4$purc;return/*#__PURE__*/_jsx(motion.div,{className:\"photo-item\",initial:{opacity:0,y:30,scale:0.9},animate:{opacity:1,y:0,scale:1},transition:{delay:index*0.1,duration:0.6,type:\"spring\",stiffness:100},whileHover:{y:-8,scale:1.02,transition:{duration:0.3}},whileTap:{scale:0.98},onClick:()=>{if(isSharedView){navigate(\"/gallery/\".concat(actualToken,\"/photo/\").concat(photo._id));}else{openLightbox(photo,index);}},children:/*#__PURE__*/_jsxs(\"div\",{className:\"photo-container\",children:[/*#__PURE__*/_jsx(LazyLoadImage,{src:photo.previewUrl||photo.thumbnailUrl||photo.url,alt:photo.title||'Gallery photo',effect:\"blur\",className:\"photo-image\",placeholderSrc:photo.thumbnailUrl}),/*#__PURE__*/_jsxs(motion.div,{className:\"photo-caption\",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:0.4,delay:index*0.05},children:[photo.title&&/*#__PURE__*/_jsx(\"div\",{className:\"caption-title\",children:photo.title}),((_photo$metadata3=photo.metadata)===null||_photo$metadata3===void 0?void 0:(_photo$metadata3$purc=_photo$metadata3.purchaseInfo)===null||_photo$metadata3$purc===void 0?void 0:_photo$metadata3$purc.price)&&/*#__PURE__*/_jsxs(\"div\",{className:\"caption-price\",children:[\"$\",photo.metadata.purchaseInfo.price.toLocaleString()]}),!photo.title&&!((_photo$metadata4=photo.metadata)!==null&&_photo$metadata4!==void 0&&(_photo$metadata4$purc=_photo$metadata4.purchaseInfo)!==null&&_photo$metadata4$purc!==void 0&&_photo$metadata4$purc.price)&&/*#__PURE__*/_jsx(\"div\",{className:\"caption-placeholder\",children:\"Untitled Artwork\"})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"photo-overlay\",initial:{opacity:0},whileHover:{opacity:1},transition:{duration:0.3},children:[/*#__PURE__*/_jsxs(motion.div,{className:\"photo-actions\",initial:{y:20,opacity:0},whileHover:{y:0,opacity:1},transition:{duration:0.3,delay:0.1},children:[/*#__PURE__*/_jsx(motion.button,{className:\"favorite-button \".concat(favorites.has(photo._id)?'active':''),onClick:e=>{e.stopPropagation();toggleFavorite(photo._id);},whileHover:{scale:1.1,rotate:5},whileTap:{scale:0.9},transition:{type:\"spring\",stiffness:300},children:/*#__PURE__*/_jsx(Heart,{className:\"action-icon\"})}),/*#__PURE__*/_jsx(motion.button,{className:\"download-button\",onClick:e=>{e.stopPropagation();downloadPhoto(photo);},whileHover:{scale:1.1,y:-2},whileTap:{scale:0.9},transition:{type:\"spring\",stiffness:300},children:/*#__PURE__*/_jsx(Download,{className:\"action-icon\"})})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"photo-info\",initial:{y:30,opacity:0},whileHover:{y:0,opacity:1},transition:{duration:0.3,delay:0.2},children:[photo.title&&/*#__PURE__*/_jsx(motion.div,{className:\"photo-title\",initial:{opacity:0},whileHover:{opacity:1},transition:{delay:0.3},children:photo.title}),photo.metadata&&/*#__PURE__*/_jsxs(motion.div,{className:\"photo-metadata\",initial:{opacity:0},whileHover:{opacity:1},transition:{delay:0.4},children:[photo.metadata.description&&/*#__PURE__*/_jsx(\"p\",{className:\"photo-description\",children:photo.metadata.description}),photo.metadata.artworkInfo&&/*#__PURE__*/_jsxs(\"div\",{className:\"artwork-info\",children:[photo.metadata.artworkInfo.medium&&/*#__PURE__*/_jsx(\"span\",{className:\"artwork-medium\",children:photo.metadata.artworkInfo.medium}),photo.metadata.artworkInfo.dimensions&&/*#__PURE__*/_jsx(\"span\",{className:\"artwork-dimensions\",children:photo.metadata.artworkInfo.dimensions}),photo.metadata.artworkInfo.year&&/*#__PURE__*/_jsx(\"span\",{className:\"artwork-year\",children:photo.metadata.artworkInfo.year})]}),photo.metadata.purchaseInfo&&photo.metadata.purchaseInfo.price&&/*#__PURE__*/_jsxs(motion.div,{className:\"photo-price\",whileHover:{scale:1.05},transition:{type:\"spring\",stiffness:300},children:[\"$\",photo.metadata.purchaseInfo.price.toLocaleString()]}),photo.metadata.purchaseInfo&&photo.metadata.purchaseInfo.available&&/*#__PURE__*/_jsx(motion.button,{className:\"inquiry-button\",onClick:e=>{e.stopPropagation();handleInquiry(photo);},whileHover:{scale:1.05,y:-2},whileTap:{scale:0.95},transition:{type:\"spring\",stiffness:300},children:\"Inquire\"})]})]})]})]})},photo._id);})})}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-gallery\",children:[/*#__PURE__*/_jsx(Camera,{className:\"empty-icon\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No photos in this gallery\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This gallery doesn't contain any photos yet.\"})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:showLightbox&&selectedPhoto&&/*#__PURE__*/_jsx(motion.div,{className:\"lightbox-overlay\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:closeLightbox,ref:lightboxRef,children:/*#__PURE__*/_jsxs(\"div\",{className:\"lightbox-container\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lightbox-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lightbox-title\",children:selectedPhoto.title||\"Photo \".concat(lightboxIndex+1,\" of \").concat(photos.length)}),/*#__PURE__*/_jsxs(\"div\",{className:\"lightbox-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"lightbox-button\",onClick:()=>setShowInfo(!showInfo),title:\"Toggle Info\",children:/*#__PURE__*/_jsx(Info,{className:\"control-icon\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"lightbox-button\",onClick:()=>downloadPhoto(selectedPhoto),title:\"Download\",children:/*#__PURE__*/_jsx(Download,{className:\"control-icon\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"lightbox-button\",onClick:closeLightbox,title:\"Close\",children:/*#__PURE__*/_jsx(X,{className:\"control-icon\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lightbox-content\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"lightbox-nav lightbox-nav-prev\",onClick:()=>navigateLightbox('prev'),disabled:photos.length<=1,children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"nav-icon\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"lightbox-nav lightbox-nav-next\",onClick:()=>navigateLightbox('next'),disabled:photos.length<=1,children:/*#__PURE__*/_jsx(ChevronRight,{className:\"nav-icon\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"lightbox-image-container\",children:/*#__PURE__*/_jsx(\"img\",{ref:imageRef,src:selectedPhoto.url,alt:selectedPhoto.title||'Gallery photo',className:\"lightbox-image\",style:{transform:\"scale(\".concat(zoom,\") rotate(\").concat(rotation,\"deg)\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"lightbox-zoom-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"zoom-button\",onClick:()=>setZoom(Math.max(0.5,zoom-0.25)),disabled:zoom<=0.5,children:/*#__PURE__*/_jsx(ZoomOut,{className:\"zoom-icon\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"zoom-level\",children:[Math.round(zoom*100),\"%\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"zoom-button\",onClick:()=>setZoom(Math.min(3,zoom+0.25)),disabled:zoom>=3,children:/*#__PURE__*/_jsx(ZoomIn,{className:\"zoom-icon\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"rotate-button\",onClick:()=>setRotation((rotation+90)%360),children:/*#__PURE__*/_jsx(RotateCw,{className:\"rotate-icon\"})})]})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:showInfo&&/*#__PURE__*/_jsxs(motion.div,{className:\"photo-info-panel\",initial:{x:'100%'},animate:{x:0},exit:{x:'100%'},transition:{type:'spring',damping:25,stiffness:200},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Photo Information\"}),/*#__PURE__*/_jsx(\"button\",{className:\"info-close\",onClick:()=>setShowInfo(false),children:/*#__PURE__*/_jsx(X,{className:\"close-icon\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-content\",children:[selectedPhoto.title&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.title})]}),((_selectedPhoto$metada=selectedPhoto.metadata)===null||_selectedPhoto$metada===void 0?void 0:_selectedPhoto$metada.description)&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.description})]}),((_selectedPhoto$metada2=selectedPhoto.metadata)===null||_selectedPhoto$metada2===void 0?void 0:_selectedPhoto$metada2.artworkInfo)&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"section-title\",children:\"Artwork Details\"}),selectedPhoto.metadata.artworkInfo.medium&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Medium\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.artworkInfo.medium})]}),selectedPhoto.metadata.artworkInfo.dimensions&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Dimensions\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.artworkInfo.dimensions})]}),selectedPhoto.metadata.artworkInfo.year&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Year\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.artworkInfo.year})]}),selectedPhoto.metadata.artworkInfo.artist&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Artist\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.artworkInfo.artist})]})]}),((_selectedPhoto$metada3=selectedPhoto.metadata)===null||_selectedPhoto$metada3===void 0?void 0:_selectedPhoto$metada3.purchaseInfo)&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"section-title\",children:\"Purchase Information\"}),selectedPhoto.metadata.purchaseInfo.price&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item price-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"price-value\",children:[\"$\",selectedPhoto.metadata.purchaseInfo.price.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Availability\"}),/*#__PURE__*/_jsx(\"span\",{className:\"availability \".concat(selectedPhoto.metadata.purchaseInfo.available?'available':'unavailable'),children:selectedPhoto.metadata.purchaseInfo.available?'Available':'Sold'})]}),selectedPhoto.metadata.purchaseInfo.edition&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Edition\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.metadata.purchaseInfo.edition})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-section\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"section-title\",children:\"Technical Details\"}),selectedPhoto.dateTaken&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date Taken\"}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(selectedPhoto.dateTaken)})]}),selectedPhoto.location&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.location})]}),selectedPhoto.exifData&&/*#__PURE__*/_jsxs(_Fragment,{children:[selectedPhoto.exifData.camera&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Camera\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.exifData.camera})]}),selectedPhoto.exifData.lens&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Lens\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedPhoto.exifData.lens})]}),formatCameraSettings(selectedPhoto.exifData)&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Settings\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCameraSettings(selectedPhoto.exifData)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Dimensions\"}),/*#__PURE__*/_jsxs(\"span\",{children:[selectedPhoto.width,\" \\xD7 \",selectedPhoto.height]})]}),selectedPhoto.fileSize&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"File Size\"}),/*#__PURE__*/_jsxs(\"span\",{children:[(selectedPhoto.fileSize/1024/1024).toFixed(2),\" MB\"]})]})]}),((_selectedPhoto$metada4=selectedPhoto.metadata)===null||_selectedPhoto$metada4===void 0?void 0:(_selectedPhoto$metada5=_selectedPhoto$metada4.purchaseInfo)===null||_selectedPhoto$metada5===void 0?void 0:_selectedPhoto$metada5.available)&&/*#__PURE__*/_jsx(\"div\",{className:\"info-section inquiry-section\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"inquiry-button-large\",onClick:()=>handleInquiry(selectedPhoto),children:[/*#__PURE__*/_jsx(Mail,{className:\"inquiry-icon\"}),\"Inquire About This Artwork\"]})})]})]})})]})})})]});};export default GalleryView;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useParams","useSearchParams","useNavigate","motion","AnimatePresence","Eye","Download","Heart","Share2","X","ChevronLeft","ChevronRight","ZoomIn","ZoomOut","RotateCw","Info","Camera","Calendar","Lock","Unlock","Mail","Sun","Moon","toast","axios","Masonry","LazyLoadImage","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GalleryView","_ref","_selectedPhoto$metada","_selectedPhoto$metada2","_selectedPhoto$metada3","_selectedPhoto$metada4","_selectedPhoto$metada5","galleryId","propGalleryId","isSharedView","paramGalleryId","searchParams","token","get","password","actualToken","gallery","setGallery","photos","setPhotos","loading","setLoading","error","setError","selectedPhoto","setSelectedPhoto","lightboxIndex","setLightboxIndex","showLightbox","setShowLightbox","showInfo","setShowInfo","zoom","setZoom","rotation","setRotation","favorites","setFavorites","Set","enteredPassword","setEnteredPassword","enteredInvitation","setEnteredInvitation","passwordError","setPasswordError","invitationError","setInvitationError","retryCount","setRetryCount","showPasswordModal","setShowPasswordModal","showInvitationModal","setShowInvitationModal","lightboxRef","imageRef","navigate","getSystemTheme","window","matchMedia","matches","theme","setTheme","darkBg","lightBg","toggleTheme","prev","mql","handler","e","addEventListener","addListener","removeEventListener","removeListener","breakpointColumnsObj","default","verifyPassword","passwordToVerify","response","post","concat","data","verified","err","console","fetchGallery","verifiedPassword","arguments","length","undefined","_data$gallery","_data$gallery2","_data$gallery3","url","params","respPhotographer","photographer","normalizedPhotographer","_objectSpread","name","firstName","lastName","trim","email","clientEmail","normalizedGallery","_err$response","_err$response2","_err$response2$data","_err$response3","_err$response4","_err$response4$data","_err$response5","_err$response6","_err$response7","_err$response8","_err$response9","_err$response9$data","status","requiresPassword","requiresInvitation","errorMessage","message","includes","handlePasswordSubmit","preventDefault","isValid","_err$response0","_err$response1","_err$response10","handleInvitationSubmit","_data$gallery4","_data$gallery5","_data$gallery6","invite","_err$response11","_err$response12","_err$response13","openLightbox","photo","index","document","body","style","overflow","closeLightbox","navigateLightbox","direction","newIndex","handleKeyPress","key","toggleFavorite","photoId","newFavorites","has","delete","add","shareGallery","navigator","share","title","text","description","location","href","clipboard","writeText","success","downloadPhoto","_id","responseType","blob","URL","createObjectURL","a","createElement","download","filename","appendChild","click","revokeObjectURL","removeChild","handleInquiry","_photo$metadata","_photo$metadata2","_photo$metadata2$purc","subject","metadata","artworkInfo","medium","year","purchaseInfo","price","toLocaleString","recipient","mailtoLink","encodeURIComponent","open","formatDate","dateString","Date","toLocaleDateString","month","day","formatCameraSettings","exif","settings","fNumber","push","exposureTime","iso","focalLength","join","className","children","onClick","disabled","backgroundColor","div","animate","x","y","rotate","transition","duration","repeat","Infinity","ease","scale","initial","opacity","exit","onSubmit","type","value","onChange","target","placeholder","autoFocus","required","h1","delay","p","whileHover","stiffness","createdAt","button","whileTap","breakpointCols","columnClassName","map","_photo$metadata3","_photo$metadata3$purc","_photo$metadata4","_photo$metadata4$purc","src","previewUrl","thumbnailUrl","alt","effect","placeholderSrc","stopPropagation","dimensions","available","ref","transform","Math","max","round","min","damping","artist","edition","dateTaken","exifData","camera","lens","width","height","fileSize","toFixed"],"sources":["C:/Users/USER/Desktop/Gallerypavilion/frontend/src/components/Gallery/GalleryView.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Eye, \n  Download, \n  Heart, \n  Share2, \n  X, \n  ChevronLeft, \n  ChevronRight,\n  ZoomIn,\n  ZoomOut,\n  RotateCw,\n  Info,\n  Camera,\n  Calendar,\n  Lock,\n  Unlock,\n  Mail,\n  Sun,\n  Moon\n} from 'lucide-react';\nimport { toast } from 'react-hot-toast';\nimport axios from 'axios';\nimport Masonry from 'react-masonry-css';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport 'react-lazy-load-image-component/src/effects/blur.css';\nimport './GalleryView.css';\n\nconst GalleryView = ({ galleryId: propGalleryId, isSharedView = false }) => {\n  const { galleryId: paramGalleryId } = useParams();\n  const [searchParams] = useSearchParams();\n  const token = searchParams.get('token');\n  const password = searchParams.get('password');\n  \n  // Use prop galleryId if provided, otherwise use URL param\n  const galleryId = propGalleryId || paramGalleryId;\n  // For shared view, treat galleryId as token\n  const actualToken = isSharedView ? galleryId : token;\n  \n  const [gallery, setGallery] = useState(null);\n  const [photos, setPhotos] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedPhoto, setSelectedPhoto] = useState(null);\n  const [lightboxIndex, setLightboxIndex] = useState(0);\n  const [showLightbox, setShowLightbox] = useState(false);\n  const [showInfo, setShowInfo] = useState(false);\n  const [zoom, setZoom] = useState(1);\n  const [rotation, setRotation] = useState(0);\n  const [favorites, setFavorites] = useState(new Set());\n  // removed unused: shareLink, passwordRequired, invitationRequired\n  const [enteredPassword, setEnteredPassword] = useState('');\n  const [enteredInvitation, setEnteredInvitation] = useState('');\n  const [passwordError, setPasswordError] = useState(null);\n  const [invitationError, setInvitationError] = useState(null);\n  const [retryCount, setRetryCount] = useState(0);\n  const [showPasswordModal, setShowPasswordModal] = useState(false);\n  const [showInvitationModal, setShowInvitationModal] = useState(false);\n  \n  const lightboxRef = useRef(null);\n  const imageRef = useRef(null);\n  \n  // Theme and navigation\n  const navigate = useNavigate();\n  const getSystemTheme = () => (\n    typeof window !== 'undefined' &&\n    window.matchMedia &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light'\n  );\n  const [theme, setTheme] = useState(getSystemTheme());\n  const darkBg = '#0b0b0b';\n  const lightBg = '#f7f7f9';\n  const toggleTheme = useCallback(() => {\n    setTheme((prev) => (prev === 'dark' ? 'light' : 'dark'));\n  }, []);\n  \n  useEffect(() => {\n    if (!window.matchMedia) return;\n    const mql = window.matchMedia('(prefers-color-scheme: dark)');\n    const handler = (e) => setTheme(e.matches ? 'dark' : 'light');\n    if (mql.addEventListener) {\n      mql.addEventListener('change', handler);\n    } else if (mql.addListener) {\n      mql.addListener(handler);\n    }\n    return () => {\n      if (mql.removeEventListener) {\n        mql.removeEventListener('change', handler);\n      } else if (mql.removeListener) {\n        mql.removeListener(handler);\n      }\n    };\n  }, []);\n  \n  // Masonry breakpoints\n  const breakpointColumnsObj = {\n    default: 4,\n    1100: 3,\n    700: 2,\n    500: 1\n  };\n  \n  // Verify password for protected share links\n  const verifyPassword = useCallback(async (passwordToVerify) => {\n    try {\n      const response = await axios.post(`/share/${actualToken}/verify-password`, {\n        password: passwordToVerify\n      });\n      return response.data.verified;\n    } catch (err) {\n      console.error('Password verification failed:', err);\n      return false;\n    }\n  }, [actualToken]);\n\n  // Fetch gallery data\n  const fetchGallery = useCallback(async (verifiedPassword = null) => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const url = actualToken\n        ? `/share/${actualToken}`\n        : `/galleries/${galleryId}/public`;\n\n      const params = {};\n      if (actualToken && (verifiedPassword || password)) {\n        params.password = verifiedPassword || password;\n      }\n\n      const response = await axios.get(url, { params });\n      const data = response.data;\n\n      // Normalize photographer info so UI can consistently use gallery.photographer.name and .email\n      const respPhotographer = data.photographer || data.gallery?.photographer;\n      const normalizedPhotographer = respPhotographer && typeof respPhotographer === 'object'\n        ? {\n            ...respPhotographer,\n            name: respPhotographer.name || `${respPhotographer.firstName || ''} ${respPhotographer.lastName || ''}`.trim(),\n            email: respPhotographer.email || respPhotographer.clientEmail || undefined,\n          }\n        : respPhotographer || undefined;\n      const normalizedGallery = {\n        ...data.gallery,\n        photographer: normalizedPhotographer || (typeof data.gallery?.photographer === 'object'\n          ? {\n              ...data.gallery.photographer,\n              name: data.gallery.photographer.name || `${data.gallery.photographer.firstName || ''} ${data.gallery.photographer.lastName || ''}`.trim(),\n            }\n          : data.gallery?.photographer),\n      };\n\n      setGallery(normalizedGallery);\n      setPhotos(data.photos || []);\n      // removed unused setShareLink\n    } catch (err) {\n      if (err.response?.status === 401 && err.response?.data?.requiresPassword) {\n        setShowPasswordModal(true);\n        return;\n      }\n     \n      if (err.response?.status === 403 && err.response?.data?.requiresInvitation) {\n        setShowInvitationModal(true);\n        return;\n      }\n      console.error('Error fetching gallery:', err);\n      \n      // Provide specific error messages based on status code\n      let errorMessage = 'Failed to load gallery';\n      if (err.response?.status === 404) {\n        errorMessage = 'Gallery not found or no longer available';\n      } else if (err.response?.status === 403) {\n        errorMessage = 'You do not have permission to access this gallery';\n      } else if (err.response?.status === 410) {\n        errorMessage = 'This gallery link has expired';\n      } else if (err.response?.status >= 500) {\n        errorMessage = 'Server error. Please try again later';\n      } else if (err.response?.data?.message) {\n        errorMessage = err.response.data.message;\n      } else if (err.message.includes('Network Error')) {\n        errorMessage = 'Network error. Please check your connection and try again';\n      }\n      \n      setError(errorMessage);\n      setRetryCount(prev => prev + 1);\n    } finally {\n      setLoading(false);\n    }\n  }, [galleryId, actualToken, password]);\n  \n  useEffect(() => {\n    fetchGallery();\n  }, [fetchGallery]);\n  \n  // Handle password submission\n  const handlePasswordSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setPasswordError(null);\n    \n    try {\n      // First verify the password\n      const isValid = await verifyPassword(enteredPassword);\n      \n      if (!isValid) {\n        setPasswordError('Incorrect password. Please try again.');\n        setLoading(false);\n        return;\n      }\n      \n      // If password is valid, fetch gallery data\n      setShowPasswordModal(false);\n      setError(null);\n      await fetchGallery(enteredPassword);\n      setEnteredPassword('');\n    } catch (err) {\n      console.error('Password submission error:', err);\n      if (err.response?.status === 401) {\n        setPasswordError('Incorrect password. Please try again.');\n      } else if (err.response?.status === 404) {\n        setPasswordError('Gallery not found or no longer available.');\n      } else if (err.response?.status >= 500) {\n        setPasswordError('Server error. Please try again later.');\n      } else {\n        setPasswordError('Failed to access gallery. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Handle invitation code submission\n  const handleInvitationSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setInvitationError(null);\n    \n    try {\n      // Fetch gallery data with invitation code\n      const url = actualToken\n        ? `/share/${actualToken}`\n        : `/galleries/${galleryId}/public`;\n\n      const params = { invite: enteredInvitation };\n      if (actualToken && password) {\n        params.password = password;\n      }\n\n      const response = await axios.get(url, { params });\n      const data = response.data;\n\n      // Normalize photographer info for consistency\n      const respPhotographer = data.photographer || data.gallery?.photographer;\n      const normalizedPhotographer = respPhotographer && typeof respPhotographer === 'object'\n        ? {\n            ...respPhotographer,\n            name: respPhotographer.name || `${respPhotographer.firstName || ''} ${respPhotographer.lastName || ''}`.trim(),\n            email: respPhotographer.email || respPhotographer.clientEmail || undefined,\n          }\n        : respPhotographer || undefined;\n      const normalizedGallery = {\n        ...data.gallery,\n        photographer: normalizedPhotographer || (typeof data.gallery?.photographer === 'object'\n          ? {\n              ...data.gallery.photographer,\n              name: data.gallery.photographer.name || `${data.gallery.photographer.firstName || ''} ${data.gallery.photographer.lastName || ''}`.trim(),\n            }\n          : data.gallery?.photographer),\n      };\n\n      setGallery(normalizedGallery);\n      setPhotos(data.photos || []);\n      setShowInvitationModal(false);\n      setError(null);\n      setEnteredInvitation('');\n    } catch (err) {\n      console.error('Invitation submission error:', err);\n      if (err.response?.status === 403) {\n        setInvitationError('Invalid or expired invitation code. Please try again.');\n      } else if (err.response?.status === 404) {\n        setInvitationError('Gallery not found or no longer available.');\n      } else if (err.response?.status >= 500) {\n        setInvitationError('Server error. Please try again later.');\n      } else {\n        setInvitationError('Failed to access gallery. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  // Open lightbox\n  const openLightbox = (photo, index) => {\n    setSelectedPhoto(photo);\n    setLightboxIndex(index);\n    setShowLightbox(true);\n    setZoom(1);\n    setRotation(0);\n    document.body.style.overflow = 'hidden';\n  };\n  \n  // Close lightbox\n  const closeLightbox = () => {\n    setShowLightbox(false);\n    setSelectedPhoto(null);\n    setShowInfo(false);\n    setZoom(1);\n    setRotation(0);\n    document.body.style.overflow = 'auto';\n  };\n  \n  // Navigate lightbox\n  const navigateLightbox = useCallback((direction) => {\n    const newIndex = direction === 'next' \n      ? (lightboxIndex + 1) % photos.length\n      : (lightboxIndex - 1 + photos.length) % photos.length;\n    setLightboxIndex(newIndex);\n    setSelectedPhoto(photos[newIndex]);\n    setZoom(1);\n    setRotation(0);\n  }, [lightboxIndex, photos]);\n  \n  // Handle keyboard navigation\n  useEffect(() => {\n    const handleKeyPress = (e) => {\n      if (!showLightbox) return;\n      switch (e.key) {\n        case 'Escape':\n          closeLightbox();\n          break;\n        case 'ArrowLeft':\n          navigateLightbox('prev');\n          break;\n        case 'ArrowRight':\n          navigateLightbox('next');\n          break;\n        case 'i':\n        case 'I':\n          setShowInfo(!showInfo);\n          break;\n        default:\n          break;\n      }\n    };\n    window.addEventListener('keydown', handleKeyPress);\n    return () => window.removeEventListener('keydown', handleKeyPress);\n  }, [showLightbox, showInfo, lightboxIndex, navigateLightbox]);\n  \n  // Toggle favorite\n  const toggleFavorite = (photoId) => {\n    const newFavorites = new Set(favorites);\n    if (newFavorites.has(photoId)) {\n      newFavorites.delete(photoId);\n    } else {\n      newFavorites.add(photoId);\n    }\n    setFavorites(newFavorites);\n  };\n  \n  // Share gallery\n  const shareGallery = async () => {\n    try {\n      if (navigator.share) {\n        await navigator.share({\n          title: gallery.title,\n          text: gallery.description,\n          url: window.location.href\n        });\n      } else {\n        await navigator.clipboard.writeText(window.location.href);\n        toast.success('Gallery link copied to clipboard!');\n      }\n    } catch (err) {\n      console.error('Error sharing:', err);\n      toast.error('Failed to share gallery');\n    }\n  };\n  \n  // Download photo\n  const downloadPhoto = async (photo) => {\n    try {\n      const response = await axios.get(`/photos/${photo._id}/download`, {\n        params: token ? { token } : undefined,\n        responseType: 'blob',\n      });\n      const blob = response.data;\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = photo.filename || `photo-${photo._id}.jpg`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast.success('Photo downloaded successfully!');\n    } catch (err) {\n      console.error('Error downloading photo:', err);\n      toast.error('Failed to download photo');\n    }\n  };\n  \n  // Handle inquiry about a photo\n  const handleInquiry = (photo) => {\n    const subject = `Inquiry about \"${photo.title || 'Artwork'}\"`;\n    const body = `Hi,\\n\\nI'm interested in learning more about the artwork \"${photo.title || 'this piece'}\"${photo.metadata?.artworkInfo ? ` (${photo.metadata.artworkInfo.medium}${photo.metadata.artworkInfo.year ? `, ${photo.metadata.artworkInfo.year}` : ''})` : ''}.\\n\\n${photo.metadata?.purchaseInfo?.price ? `Listed price: $${photo.metadata.purchaseInfo.price.toLocaleString()}\\n\\n` : ''}Please provide more information about:\\n- Availability\\n- Pricing details\\n- Shipping information\\n- Any additional details\\n\\nThank you!`;\n    const recipient = (gallery && gallery.photographer && gallery.photographer.email) ? gallery.photographer.email : '';\n    const mailtoLink = `mailto:${encodeURIComponent(recipient)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n    window.open(mailtoLink, '_blank');\n  };\n  \n  // Format date\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n  \n  // Format camera settings\n  const formatCameraSettings = (exif) => {\n    if (!exif) return null;\n    \n    const settings = [];\n    if (exif.fNumber) settings.push(`f/${exif.fNumber}`);\n    if (exif.exposureTime) settings.push(`${exif.exposureTime}s`);\n    if (exif.iso) settings.push(`ISO ${exif.iso}`);\n    if (exif.focalLength) settings.push(`${exif.focalLength}mm`);\n    \n    return settings.length > 0 ? settings.join(' • ') : null;\n  };\n  \n\n  \n  if (loading) {\n    return (\n      <div className=\"gallery-loading\">\n        <div className=\"loading-spinner\"></div>\n        <p>Loading gallery...</p>\n      </div>\n    );\n  }\n  \n  if (error) {\n    return (\n      <div className=\"gallery-error\">\n        <div className=\"error-content\">\n          <div className=\"error-icon\">⚠️</div>\n          <h2>Unable to Load Gallery</h2>\n          <p className=\"error-message\">{error}</p>\n          \n          <div className=\"error-actions\">\n            <button \n              onClick={() => {\n                setError(null);\n                setRetryCount(0);\n                fetchGallery();\n              }} \n              className=\"retry-button\"\n              disabled={loading}\n            >\n              {loading ? 'Retrying...' : 'Try Again'}\n            </button>\n            \n            {retryCount > 2 && (\n              <button \n                onClick={() => window.location.href = '/'} \n                className=\"home-button\"\n              >\n                Go to Homepage\n              </button>\n            )}\n          </div>\n          \n          {retryCount > 1 && (\n            <div className=\"error-help\">\n              <p>Still having trouble? Try:</p>\n              <ul>\n                <li>Checking your internet connection</li>\n                <li>Refreshing the page</li>\n                <li>Contacting the gallery owner</li>\n              </ul>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n  \n  return (\n    <div className={`gallery-view ${theme}`} style={{ backgroundColor: theme === 'dark' ? darkBg : lightBg }}>\n      {/* Animated Background Elements */}\n      <div className=\"animated-background\">\n        <motion.div \n          className=\"bg-gradient-1\"\n          animate={{\n            x: [0, 100, 0],\n            y: [0, -50, 0],\n            rotate: [0, 180, 360]\n          }}\n          transition={{\n            duration: 20,\n            repeat: Infinity,\n            ease: \"linear\"\n          }}\n        />\n        <motion.div \n          className=\"bg-gradient-2\"\n          animate={{\n            x: [0, -80, 0],\n            y: [0, 100, 0],\n            rotate: [0, -180, -360]\n          }}\n          transition={{\n            duration: 25,\n            repeat: Infinity,\n            ease: \"linear\"\n          }}\n        />\n        <motion.div \n          className=\"bg-gradient-3\"\n          animate={{\n            x: [0, 60, 0],\n            y: [0, -80, 0],\n            scale: [1, 1.2, 1]\n          }}\n          transition={{\n            duration: 30,\n            repeat: Infinity,\n            ease: \"linear\"\n          }}\n        />\n       </div>\n      {/* Password Modal */}\n      <AnimatePresence>\n        {showPasswordModal && (\n          <motion.div \n            className=\"password-modal-overlay\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            <motion.div \n              className=\"password-modal\"\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n            >\n              <div className=\"password-modal-header\">\n                <Lock className=\"lock-icon\" />\n                <h2>Password Required</h2>\n                <p>This gallery is password protected</p>\n              </div>\n              \n              <form onSubmit={handlePasswordSubmit} className=\"password-form\">\n                <div className=\"password-input-container\">\n                  <input\n                    type=\"password\"\n                    value={enteredPassword}\n                    onChange={(e) => {\n                      setEnteredPassword(e.target.value);\n                      setPasswordError(null); // Clear error when user types\n                    }}\n                    placeholder=\"Enter password\"\n                    className={`password-input ${passwordError ? 'error' : ''}`}\n                    autoFocus\n                    required\n                    disabled={loading}\n                  />\n                  {passwordError && (\n                    <div className=\"password-error\">\n                      <span className=\"error-icon\">⚠️</span>\n                      <span className=\"error-text\">{passwordError}</span>\n                    </div>\n                  )}\n                </div>\n                \n                <button \n                  type=\"submit\" \n                  className=\"password-submit\"\n                  disabled={loading || !enteredPassword.trim()}\n                >\n                  {loading ? (\n                    <>\n                      <div className=\"loading-spinner\"></div>\n                      Verifying...\n                    </>\n                  ) : (\n                    <>\n                      <Unlock className=\"unlock-icon\" />\n                      Access Gallery\n                    </>\n                  )}\n                </button>\n              </form>\n              \n              <div className=\"password-modal-footer\">\n                <p className=\"help-text\">\n                  Don't have the password? Contact the gallery owner.\n                </p>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Invitation Modal */}\n      <AnimatePresence>\n        {showInvitationModal && (\n          <motion.div \n            className=\"password-modal-overlay\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            <motion.div \n              className=\"password-modal\"\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n            >\n              <div className=\"password-modal-header\">\n                <Lock className=\"lock-icon\" />\n                <h2>Invitation Required</h2>\n                <p>This gallery is invite-only. Please enter your invitation code.</p>\n              </div>\n              \n              <form onSubmit={handleInvitationSubmit} className=\"password-form\">\n                <div className=\"password-input-container\">\n                  <input\n                    type=\"text\"\n                    value={enteredInvitation}\n                    onChange={(e) => {\n                      setEnteredInvitation(e.target.value);\n                      setInvitationError(null); // Clear error when user types\n                    }}\n                    placeholder=\"Enter invitation code\"\n                    className={`password-input ${invitationError ? 'error' : ''}`}\n                    autoFocus\n                    required\n                    disabled={loading}\n                  />\n                  {invitationError && (\n                    <div className=\"password-error\">\n                      <span className=\"error-icon\">⚠️</span>\n                      <span className=\"error-text\">{invitationError}</span>\n                    </div>\n                  )}\n                </div>\n                \n                <button \n                  type=\"submit\" \n                  className=\"password-submit\"\n                  disabled={loading || !enteredInvitation.trim()}\n                >\n                  {loading ? (\n                    <>\n                      <div className=\"loading-spinner\"></div>\n                      Verifying...\n                    </>\n                  ) : (\n                    <>\n                      <Unlock className=\"unlock-icon\" />\n                      Access Gallery\n                    </>\n                  )}\n                </button>\n              </form>\n              \n              <div className=\"password-modal-footer\">\n                <p className=\"help-text\">\n                  Don't have an invitation code? Contact the gallery owner.\n                </p>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      \n      {/* Gallery Header */}\n      {gallery && (\n        <motion.div \n          className=\"gallery-header\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, ease: \"easeOut\" }}\n        >\n          <div className=\"gallery-info\">\n            <motion.h1 \n              className=\"gallery-title\"\n              initial={{ opacity: 0, x: -30 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.8, delay: 0.2 }}\n            >\n              {gallery.title}\n            </motion.h1>\n            {gallery.description && (\n              <motion.p \n                className=\"gallery-description\"\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ duration: 0.8, delay: 0.4 }}\n              >\n                {gallery.description}\n              </motion.p>\n            )}\n            \n            <motion.div \n              className=\"gallery-meta\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.8, delay: 0.6 }}\n            >\n              {gallery.photographer && (\n                <motion.div \n                  className=\"photographer-info\"\n                  whileHover={{ scale: 1.05, x: 5 }}\n                  transition={{ type: \"spring\", stiffness: 300 }}\n                >\n                  <div className=\"meta-icon-container\">\n                    <Camera className=\"meta-icon\" />\n                  </div>\n                  <span>by {gallery.photographer.name}</span>\n                </motion.div>\n              )}\n              \n              <motion.div \n                className=\"photo-count\"\n                whileHover={{ scale: 1.05, x: 5 }}\n                transition={{ type: \"spring\", stiffness: 300 }}\n              >\n                <div className=\"meta-icon-container\">\n                  <Eye className=\"meta-icon\" />\n                </div>\n                <span>{photos.length} photos</span>\n              </motion.div>\n              \n              {gallery.createdAt && (\n                <motion.div \n                  className=\"gallery-date\"\n                  whileHover={{ scale: 1.05, x: 5 }}\n                  transition={{ type: \"spring\", stiffness: 300 }}\n                >\n                  <div className=\"meta-icon-container\">\n                    <Calendar className=\"meta-icon\" />\n                  </div>\n                  <span>{formatDate(gallery.createdAt)}</span>\n                </motion.div>\n              )}\n            </motion.div>\n          </div>\n          \n          <motion.div \n            className=\"gallery-actions\"\n            initial={{ opacity: 0, x: 30 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.8, delay: 0.8 }}\n          >\n            <motion.button \n              onClick={shareGallery} \n              className=\"action-button\"\n              whileHover={{ scale: 1.05, y: -2 }}\n              whileTap={{ scale: 0.95 }}\n              transition={{ type: \"spring\", stiffness: 300 }}\n            >\n              <Share2 className=\"action-icon\" />\n              <span>Share</span>\n            </motion.button>\n            <motion.button \n              onClick={toggleTheme} \n              className=\"action-button theme-toggle\" \n              aria-label=\"Toggle theme\"\n              whileHover={{ scale: 1.05, y: -2 }}\n              whileTap={{ scale: 0.95 }}\n              transition={{ type: \"spring\", stiffness: 300 }}\n            >\n              <motion.div\n                animate={{ rotate: theme === 'dark' ? 0 : 180 }}\n                transition={{ duration: 0.5 }}\n              >\n                {theme === 'dark' ? <Sun className=\"action-icon\" /> : <Moon className=\"action-icon\" />}\n              </motion.div>\n              <span>{theme === 'dark' ? 'Light' : 'Dark'}</span>\n            </motion.button>\n          </motion.div>\n        </motion.div>\n      )}\n      \n      {/* Photo Grid */}\n      {photos.length > 0 ? (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.8, delay: 1 }}\n        >\n          <Masonry\n            breakpointCols={breakpointColumnsObj}\n            className=\"photo-masonry\"\n            columnClassName=\"photo-masonry-column\"\n          >\n            {photos.map((photo, index) => (\n              <motion.div\n                key={photo._id}\n                className=\"photo-item\"\n                initial={{ opacity: 0, y: 30, scale: 0.9 }}\n                animate={{ opacity: 1, y: 0, scale: 1 }}\n                transition={{ \n                  delay: index * 0.1,\n                  duration: 0.6,\n                  type: \"spring\",\n                  stiffness: 100\n                }}\n                whileHover={{ \n                  y: -8,\n                  scale: 1.02,\n                  transition: { duration: 0.3 }\n                }}\n                whileTap={{ scale: 0.98 }}\n                onClick={() => {\n                  if (isSharedView) {\n                    navigate(`/gallery/${actualToken}/photo/${photo._id}`);\n                  } else {\n                    openLightbox(photo, index);\n                  }\n                }}\n              >\n              <div className=\"photo-container\">\n                <LazyLoadImage\n                  src={photo.previewUrl || photo.thumbnailUrl || photo.url}\n                  alt={photo.title || 'Gallery photo'}\n                  effect=\"blur\"\n                  className=\"photo-image\"\n                  placeholderSrc={photo.thumbnailUrl}\n                />\n                \n                {/* Visible caption below photo */}\n                <motion.div \n                  className=\"photo-caption\"\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.4, delay: index * 0.05 }}\n                >\n                  {photo.title && (\n                    <div className=\"caption-title\">\n                      {photo.title}\n                    </div>\n                  )}\n                  \n                  {photo.metadata?.purchaseInfo?.price && (\n                    <div className=\"caption-price\">\n                      ${photo.metadata.purchaseInfo.price.toLocaleString()}\n                    </div>\n                  )}\n                  \n                  {!photo.title && !photo.metadata?.purchaseInfo?.price && (\n                    <div className=\"caption-placeholder\">\n                      Untitled Artwork\n                    </div>\n                  )}\n                </motion.div>\n                \n                <motion.div \n                  className=\"photo-overlay\"\n                  initial={{ opacity: 0 }}\n                  whileHover={{ opacity: 1 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <motion.div \n                    className=\"photo-actions\"\n                    initial={{ y: 20, opacity: 0 }}\n                    whileHover={{ y: 0, opacity: 1 }}\n                    transition={{ duration: 0.3, delay: 0.1 }}\n                  >\n                    <motion.button \n                      className={`favorite-button ${favorites.has(photo._id) ? 'active' : ''}`}\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        toggleFavorite(photo._id);\n                      }}\n                      whileHover={{ scale: 1.1, rotate: 5 }}\n                      whileTap={{ scale: 0.9 }}\n                      transition={{ type: \"spring\", stiffness: 300 }}\n                    >\n                      <Heart className=\"action-icon\" />\n                    </motion.button>\n                    \n                    <motion.button \n                      className=\"download-button\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        downloadPhoto(photo);\n                      }}\n                      whileHover={{ scale: 1.1, y: -2 }}\n                      whileTap={{ scale: 0.9 }}\n                      transition={{ type: \"spring\", stiffness: 300 }}\n                    >\n                      <Download className=\"action-icon\" />\n                    </motion.button>\n                  </motion.div>\n                  \n                  <motion.div \n                    className=\"photo-info\"\n                    initial={{ y: 30, opacity: 0 }}\n                    whileHover={{ y: 0, opacity: 1 }}\n                    transition={{ duration: 0.3, delay: 0.2 }}\n                  >\n                    {photo.title && (\n                      <motion.div \n                        className=\"photo-title\"\n                        initial={{ opacity: 0 }}\n                        whileHover={{ opacity: 1 }}\n                        transition={{ delay: 0.3 }}\n                      >\n                        {photo.title}\n                      </motion.div>\n                    )}\n                    \n                    {photo.metadata && (\n                      <motion.div \n                        className=\"photo-metadata\"\n                        initial={{ opacity: 0 }}\n                        whileHover={{ opacity: 1 }}\n                        transition={{ delay: 0.4 }}\n                      >\n                        {photo.metadata.description && (\n                          <p className=\"photo-description\">{photo.metadata.description}</p>\n                        )}\n                        \n                        {photo.metadata.artworkInfo && (\n                          <div className=\"artwork-info\">\n                            {photo.metadata.artworkInfo.medium && (\n                              <span className=\"artwork-medium\">{photo.metadata.artworkInfo.medium}</span>\n                            )}\n                            {photo.metadata.artworkInfo.dimensions && (\n                              <span className=\"artwork-dimensions\">{photo.metadata.artworkInfo.dimensions}</span>\n                            )}\n                            {photo.metadata.artworkInfo.year && (\n                              <span className=\"artwork-year\">{photo.metadata.artworkInfo.year}</span>\n                            )}\n                          </div>\n                        )}\n                        \n                        {photo.metadata.purchaseInfo && photo.metadata.purchaseInfo.price && (\n                          <motion.div \n                            className=\"photo-price\"\n                            whileHover={{ scale: 1.05 }}\n                            transition={{ type: \"spring\", stiffness: 300 }}\n                          >\n                            ${photo.metadata.purchaseInfo.price.toLocaleString()}\n                          </motion.div>\n                        )}\n                        \n                        {photo.metadata.purchaseInfo && photo.metadata.purchaseInfo.available && (\n                          <motion.button \n                            className=\"inquiry-button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleInquiry(photo);\n                            }}\n                            whileHover={{ scale: 1.05, y: -2 }}\n                            whileTap={{ scale: 0.95 }}\n                            transition={{ type: \"spring\", stiffness: 300 }}\n                          >\n                            Inquire\n                          </motion.button>\n                        )}\n                      </motion.div>\n                    )}\n                  </motion.div>\n                </motion.div>\n              </div>\n            </motion.div>\n          ))}\n          </Masonry>\n        </motion.div>\n      ) : (\n        <div className=\"empty-gallery\">\n          <Camera className=\"empty-icon\" />\n          <h3>No photos in this gallery</h3>\n          <p>This gallery doesn't contain any photos yet.</p>\n        </div>\n      )}\n      \n      {/* Lightbox */}\n      <AnimatePresence>\n        {showLightbox && selectedPhoto && (\n          <motion.div \n            className=\"lightbox-overlay\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={closeLightbox}\n            ref={lightboxRef}\n          >\n            <div className=\"lightbox-container\" onClick={(e) => e.stopPropagation()}>\n              {/* Lightbox Header */}\n              <div className=\"lightbox-header\">\n                <div className=\"lightbox-title\">\n                  {selectedPhoto.title || `Photo ${lightboxIndex + 1} of ${photos.length}`}\n                </div>\n                \n                <div className=\"lightbox-controls\">\n                  <button \n                    className=\"lightbox-button\"\n                    onClick={() => setShowInfo(!showInfo)}\n                    title=\"Toggle Info\"\n                  >\n                    <Info className=\"control-icon\" />\n                  </button>\n                  \n                  <button \n                    className=\"lightbox-button\"\n                    onClick={() => downloadPhoto(selectedPhoto)}\n                    title=\"Download\"\n                  >\n                    <Download className=\"control-icon\" />\n                  </button>\n                  \n                  <button \n                    className=\"lightbox-button\"\n                    onClick={closeLightbox}\n                    title=\"Close\"\n                  >\n                    <X className=\"control-icon\" />\n                  </button>\n                </div>\n              </div>\n              \n              {/* Lightbox Content */}\n              <div className=\"lightbox-content\">\n                {/* Navigation */}\n                <button \n                  className=\"lightbox-nav lightbox-nav-prev\"\n                  onClick={() => navigateLightbox('prev')}\n                  disabled={photos.length <= 1}\n                >\n                  <ChevronLeft className=\"nav-icon\" />\n                </button>\n                \n                <button \n                  className=\"lightbox-nav lightbox-nav-next\"\n                  onClick={() => navigateLightbox('next')}\n                  disabled={photos.length <= 1}\n                >\n                  <ChevronRight className=\"nav-icon\" />\n                </button>\n                \n                {/* Image */}\n                <div className=\"lightbox-image-container\">\n                  <img\n                    ref={imageRef}\n                    src={selectedPhoto.url}\n                    alt={selectedPhoto.title || 'Gallery photo'}\n                    className=\"lightbox-image\"\n                    style={{\n                      transform: `scale(${zoom}) rotate(${rotation}deg)`\n                    }}\n                  />\n                </div>\n                \n                {/* Zoom Controls */}\n                <div className=\"lightbox-zoom-controls\">\n                  <button \n                    className=\"zoom-button\"\n                    onClick={() => setZoom(Math.max(0.5, zoom - 0.25))}\n                    disabled={zoom <= 0.5}\n                  >\n                    <ZoomOut className=\"zoom-icon\" />\n                  </button>\n                  \n                  <span className=\"zoom-level\">{Math.round(zoom * 100)}%</span>\n                  \n                  <button \n                    className=\"zoom-button\"\n                    onClick={() => setZoom(Math.min(3, zoom + 0.25))}\n                    disabled={zoom >= 3}\n                  >\n                    <ZoomIn className=\"zoom-icon\" />\n                  </button>\n                  \n                  <button \n                    className=\"rotate-button\"\n                    onClick={() => setRotation((rotation + 90) % 360)}\n                  >\n                    <RotateCw className=\"rotate-icon\" />\n                  </button>\n                </div>\n              </div>\n              \n              {/* Photo Info Panel */}\n              <AnimatePresence>\n                {showInfo && (\n                  <motion.div \n                    className=\"photo-info-panel\"\n                    initial={{ x: '100%' }}\n                    animate={{ x: 0 }}\n                    exit={{ x: '100%' }}\n                    transition={{ type: 'spring', damping: 25, stiffness: 200 }}\n                  >\n                    <div className=\"info-header\">\n                      <h3>Photo Information</h3>\n                      <button \n                        className=\"info-close\"\n                        onClick={() => setShowInfo(false)}\n                      >\n                        <X className=\"close-icon\" />\n                      </button>\n                    </div>\n                    \n                    <div className=\"info-content\">\n                      {selectedPhoto.title && (\n                        <div className=\"info-item\">\n                          <label>Title</label>\n                          <span>{selectedPhoto.title}</span>\n                        </div>\n                      )}\n                      \n                      {selectedPhoto.metadata?.description && (\n                        <div className=\"info-item\">\n                          <label>Description</label>\n                          <span>{selectedPhoto.metadata.description}</span>\n                        </div>\n                      )}\n                      \n                      {/* Artwork Information */}\n                      {selectedPhoto.metadata?.artworkInfo && (\n                        <div className=\"info-section\">\n                          <h4 className=\"section-title\">Artwork Details</h4>\n                          \n                          {selectedPhoto.metadata.artworkInfo.medium && (\n                            <div className=\"info-item\">\n                              <label>Medium</label>\n                              <span>{selectedPhoto.metadata.artworkInfo.medium}</span>\n                            </div>\n                          )}\n                          \n                          {selectedPhoto.metadata.artworkInfo.dimensions && (\n                            <div className=\"info-item\">\n                              <label>Dimensions</label>\n                              <span>{selectedPhoto.metadata.artworkInfo.dimensions}</span>\n                            </div>\n                          )}\n                          \n                          {selectedPhoto.metadata.artworkInfo.year && (\n                            <div className=\"info-item\">\n                              <label>Year</label>\n                              <span>{selectedPhoto.metadata.artworkInfo.year}</span>\n                            </div>\n                          )}\n                          \n                          {selectedPhoto.metadata.artworkInfo.artist && (\n                            <div className=\"info-item\">\n                              <label>Artist</label>\n                              <span>{selectedPhoto.metadata.artworkInfo.artist}</span>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      {/* Purchase Information */}\n                      {selectedPhoto.metadata?.purchaseInfo && (\n                        <div className=\"info-section\">\n                          <h4 className=\"section-title\">Purchase Information</h4>\n                          \n                          {selectedPhoto.metadata.purchaseInfo.price && (\n                            <div className=\"info-item price-item\">\n                              <label>Price</label>\n                              <span className=\"price-value\">${selectedPhoto.metadata.purchaseInfo.price.toLocaleString()}</span>\n                            </div>\n                          )}\n                          \n                          <div className=\"info-item\">\n                            <label>Availability</label>\n                            <span className={`availability ${selectedPhoto.metadata.purchaseInfo.available ? 'available' : 'unavailable'}`}>\n                              {selectedPhoto.metadata.purchaseInfo.available ? 'Available' : 'Sold'}\n                            </span>\n                          </div>\n                          \n                          {selectedPhoto.metadata.purchaseInfo.edition && (\n                            <div className=\"info-item\">\n                              <label>Edition</label>\n                              <span>{selectedPhoto.metadata.purchaseInfo.edition}</span>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      {/* Technical Information */}\n                      <div className=\"info-section\">\n                        <h4 className=\"section-title\">Technical Details</h4>\n                        \n                        {selectedPhoto.dateTaken && (\n                          <div className=\"info-item\">\n                            <label>Date Taken</label>\n                            <span>{formatDate(selectedPhoto.dateTaken)}</span>\n                          </div>\n                        )}\n                        \n                        {selectedPhoto.location && (\n                          <div className=\"info-item\">\n                            <label>Location</label>\n                            <span>{selectedPhoto.location}</span>\n                          </div>\n                        )}\n                        \n                        {selectedPhoto.exifData && (\n                          <>\n                            {selectedPhoto.exifData.camera && (\n                              <div className=\"info-item\">\n                                <label>Camera</label>\n                                <span>{selectedPhoto.exifData.camera}</span>\n                              </div>\n                            )}\n                            \n                            {selectedPhoto.exifData.lens && (\n                              <div className=\"info-item\">\n                                <label>Lens</label>\n                                <span>{selectedPhoto.exifData.lens}</span>\n                              </div>\n                            )}\n                            \n                            {formatCameraSettings(selectedPhoto.exifData) && (\n                              <div className=\"info-item\">\n                                <label>Settings</label>\n                                <span>{formatCameraSettings(selectedPhoto.exifData)}</span>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        \n                        <div className=\"info-item\">\n                          <label>Dimensions</label>\n                          <span>{selectedPhoto.width} × {selectedPhoto.height}</span>\n                        </div>\n                        \n                        {selectedPhoto.fileSize && (\n                          <div className=\"info-item\">\n                            <label>File Size</label>\n                            <span>{(selectedPhoto.fileSize / 1024 / 1024).toFixed(2)} MB</span>\n                          </div>\n                        )}\n                      </div>\n                      \n                      {/* Inquiry Section */}\n                      {selectedPhoto.metadata?.purchaseInfo?.available && (\n                        <div className=\"info-section inquiry-section\">\n                          <button \n                            className=\"inquiry-button-large\"\n                            onClick={() => handleInquiry(selectedPhoto)}\n                          >\n                            <Mail className=\"inquiry-icon\" />\n                            Inquire About This Artwork\n                          </button>\n                        </div>\n                      )}\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n             </div>\n           </motion.div>\n         )}\n       </AnimatePresence>\n     </div>\n   );\n };\n \n export default GalleryView;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}